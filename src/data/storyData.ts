export interface StoryChoice {
  id: string;
  emoji: string;
  title: string;
  description: string;
  tag: string; // collected preference tag
}

export interface StoryStage {
  id: number;
  title: string;
  narrative: string;
  choices: StoryChoice[];
}

export const storyStages: StoryStage[] = [
  {
    id: 1,
    title: "éªé©¬è¸æ˜¥",
    narrative: "æ–°æ˜¥ä¼Šå§‹ï¼Œä¸€åŒ¹é‡‘è‰²éªé©¬è½½ç€ä½ æ¥åˆ°ä¸€ç‰‡ç¥ç§˜çš„å²”è·¯å£ã€‚è¿œæ–¹ä¼ æ¥ä¸‰ç§ä¸åŒçš„å£°éŸ³ï¼Œä½ å¾ªç€å“ªä¸ªæ–¹å‘å‰è¡Œï¼Ÿ",
    choices: [
      {
        id: "1a",
        emoji: "ğŸ”ï¸",
        title: "å±±å·…çš„é’Ÿå£°",
        description: "æ”€ç™»é«˜å³°ï¼Œè¿½æ±‚äº‹ä¸šçš„å·…å³°",
        tag: "äº‹ä¸š",
      },
      {
        id: "1b",
        emoji: "ğŸŒ¸",
        title: "èŠ±æµ·çš„æ­Œè°£",
        description: "èµ°è¿›èŠ±æµ·ï¼Œå¯»æ‰¾å¿ƒä¸­çš„æ¸©æŸ”",
        tag: "çˆ±æƒ…",
      },
      {
        id: "1c",
        emoji: "ğŸŒŠ",
        title: "æºªæµçš„ä½è¯­",
        description: "æ²¿ç€æºªæµï¼Œæ„Ÿå—å†…å¿ƒçš„å¹³é™",
        tag: "å¥åº·",
      },
    ],
  },
  {
    id: 2,
    title: "ç¥é©¬èµå®",
    narrative: "éªé©¬å¸¦ä½ æ¥åˆ°ä¸€åº§å¤è€çš„å®åº“ï¼Œä¸‰ä»¶å®ç‰©é—ªé—ªå‘å…‰ã€‚ä½ è¢«å“ªä¸€ä»¶æ·±æ·±å¸å¼•ï¼Ÿ",
    choices: [
      {
        id: "2a",
        emoji: "ğŸ’",
        title: "æ™ºæ…§ä¹‹é•œ",
        description: "æ´å¯Ÿä¸–äº‹ï¼Œæ˜è¾¨æ˜¯é",
        tag: "æ™ºæ…§",
      },
      {
        id: "2b",
        emoji: "ğŸ®",
        title: "ç¦è¿ç¯ç¬¼",
        description: "ç‚¹äº®å‰è·¯ï¼Œå¥½è¿è¿è¿",
        tag: "å¥½è¿",
      },
      {
        id: "2c",
        emoji: "ğŸ­",
        title: "æ¬¢ä¹é¢å…·",
        description: "ç¬‘å£å¸¸å¼€ï¼Œä¹äº«ç”Ÿæ´»",
        tag: "å¿«ä¹",
      },
    ],
  },
  {
    id: 3,
    title: "ä¸‡é©¬å¥”è…¾",
    narrative: "å‰æ–¹å‡ºç°ä¸€åœºç››å¤§çš„èµ›é©¬å¤§ä¼šï¼ä½ é€‰æ‹©ä»¥ä½•ç§æ–¹å¼å‚åŠ è¿™åœºç››äº‹ï¼Ÿ",
    choices: [
      {
        id: "3a",
        emoji: "ğŸ",
        title: "å¾¡é©¬é£å¥”",
        description: "å‹‡å¾€ç›´å‰ï¼Œæ•¢ä¸ºäººå…ˆ",
        tag: "å‹‡æ°”",
      },
      {
        id: "3b",
        emoji: "ğŸª",
        title: "æ¬¢èšå–å½©",
        description: "ä¸æœ‹å‹å…±äº«æ¬¢ä¹æ—¶å…‰",
        tag: "å‹æƒ…",
      },
      {
        id: "3c",
        emoji: "ğŸ“œ",
        title: "è®°å½•ä¼ å¥‡",
        description: "ç”¨ç¬”å¢¨è®°å½•ç²¾å½©ç¬é—´",
        tag: "æˆé•¿",
      },
    ],
  },
  {
    id: 4,
    title: "é©¬åˆ°æˆåŠŸ",
    narrative: "æ—…é€”çš„ç»ˆç‚¹ï¼Œéªé©¬åŒ–ä½œæ¼«å¤©æ˜Ÿå…‰ã€‚æœ€åï¼Œä½ è®¸ä¸‹æ€æ ·çš„æ–°å¹´å¿ƒæ„¿ï¼Ÿ",
    choices: [
      {
        id: "4a",
        emoji: "â­",
        title: "æ˜Ÿè¾°å¤§æµ·",
        description: "è¿½é€æ¢¦æƒ³ï¼Œæ— æ‰€ç•æƒ§",
        tag: "æ¢¦æƒ³",
      },
      {
        id: "4b",
        emoji: "ğŸ¡",
        title: "å²æœˆé™å¥½",
        description: "å®¶äººå¹³å®‰ï¼Œæ¸©é¦¨ç›¸ä¼´",
        tag: "å®¶åº­",
      },
      {
        id: "4c",
        emoji: "ğŸŒˆ",
        title: "ä¸‡äº‹å¦‚æ„",
        description: "å¿ƒæƒ³äº‹æˆï¼Œä¸‡äº‹é¡ºé‚",
        tag: "é¡ºé‚",
      },
    ],
  },
];

export function generateBlessing(tags: string[]): string {
  const blessingMap: Record<string, string> = {
    äº‹ä¸š: "äº‹ä¸šè…¾é£ï¼Œæ­¥æ­¥é«˜å‡",
    çˆ±æƒ…: "æƒ…ç¼˜ç¾æ»¡ï¼Œç”œèœœç›¸ä¼´",
    å¥åº·: "èº«ä½“åº·å¥ï¼Œæ´»åŠ›æ»¡æ»¡",
    æ™ºæ…§: "èªæ…§è¿‡äººï¼Œæ˜å¯Ÿç§‹æ¯«",
    å¥½è¿: "å¥½è¿å½“å¤´ï¼Œè¯¸äº‹é¡ºé‚",
    å¿«ä¹: "ç¬‘å£å¸¸å¼€ï¼Œå¹¸ç¦æ»¡æº¢",
    å‹‡æ°”: "å‹‡å¾€ç›´å‰ï¼ŒæŠ«è†æ–©æ£˜",
    å‹æƒ…: "çŸ¥å·±ç›¸ä¼´ï¼Œæ¸©æš–å¦‚æ˜¥",
    æˆé•¿: "æ—¥æ—¥ç²¾è¿›ï¼Œæ”¶è·æ»¡æ»¡",
    æ¢¦æƒ³: "å¿ƒä¹‹æ‰€å‘ï¼Œç»ˆå°†æŠµè¾¾",
    å®¶åº­: "é˜–å®¶æ¬¢ä¹ï¼Œå¹¸ç¦å®‰åº·",
    é¡ºé‚: "ä¸‡äº‹å¦‚æ„ï¼Œå¿ƒæƒ³äº‹æˆ",
  };

  const blessings = tags.map((tag) => blessingMap[tag] || "ç¦æ˜Ÿé«˜ç…§");
  
  const intro = "ğŸ´ é©¬å¹´å¤§å‰ ğŸ´\n\n";
  const body = `åœ¨è¿™æ®µå¥‡å¦™çš„æ—…é€”ä¸­ï¼Œä½ é€‰æ‹©äº†${tags.join("ã€")}ã€‚\n\néªé©¬ä¸ºä½ é€ä¸Šä¸“å±ç¥ç¦ï¼š\n\n`;
  const list = blessings.map((b, i) => `âœ¨ ${b}`).join("\n");
  const outro = "\n\nğŸ§§ æ„¿ä½ é©¬å¹´ä¸€é©¬å½“å…ˆï¼Œé©¬åˆ°æˆåŠŸï¼ğŸ§§";

  return intro + body + list + outro;
}
